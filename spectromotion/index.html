<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-4">Results and comparisons</h2>
    <p>
      Here we display side-by-side videos comparing our method to top-performing baselines across different captured scenes. <br><br>
      Select a scene, baseline method, and view below:
    </p>
    <br>
    <div class="tabs-widget">
      <div class="tabs is-centered">
        <ul class="is-marginless" id="scene-tabs">
          <!-- Scene tabs will be dynamically inserted here -->
        </ul>
      </div>
      <div class="tabs is-centered is-toggle is-toggle-rounded is-small">
        <ul class="is-marginless" id="method-tabs">
          <!-- Method tabs will be dynamically inserted here -->
        </ul>
      </div>
      <div class="tabs is-centered is-toggle is-toggle-rounded is-small">
        <ul class="is-marginless" id="view-tabs">
          <!-- View tabs will be dynamically inserted here -->
        </ul>
      </div>
      <div class="content has-text-centered is-size-7-mobile">
        Interactive visualization. Hover or tap to move the split.
      </div>
      <div id="video-container">
        <!-- Video comparisons will be dynamically inserted here -->
      </div>
    </div>
  </div>
</section>

<script>
  const scenes = ['as', 'basin', 'bell', 'cup', 'plate', 'press', 'sieve'];
  const methods = ['NeRF-DS', 'Deformable 3DGS', '4DGS', 'GaussianShader', 'GS-IR', 'HyperNeRF'];
  const views = ['RGB', 'Depth', 'Normal'];

  // State object to store selections for each scene
  const state = {};
  scenes.forEach(scene => {
    state[scene] = {
      method: methods[0],
      view: views[0]
    };
  });

  let currentScene = scenes[0];

  function createTabs(containerId, items, clickHandler) {
    const container = document.getElementById(containerId);
    items.forEach((item, index) => {
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.textContent = item;
      a.onclick = () => clickHandler(item);
      li.appendChild(a);
      container.appendChild(li);
    });
  }

  function updateActiveTab(containerId, activeItem) {
    const tabs = document.querySelectorAll(`#${containerId} li`);
    tabs.forEach(tab => {
      tab.className = tab.textContent === activeItem ? 'is-active' : '';
    });
  }

  function createVideoComparison() {
    const container = document.getElementById('video-container');
    container.innerHTML = ''; // Clear existing content

    const currentMethod = state[currentScene].method;
    const currentView = state[currentScene].view;

    const videoComparison = document.createElement('div');
    videoComparison.className = 'video-comparison';
    videoComparison.setAttribute('data-label', currentMethod);
    videoComparison.setAttribute('data-label2', 'Ours');

    const video = document.createElement('video');
    video.className = 'video';
    video.width = '100%';
    video.loop = true;
    video.playsinline = true;
    video.muted = true;
    video.src = `./static/videos/${currentMethod.toLowerCase()}_${currentScene}_ours_${currentScene}_${currentView.toLowerCase()}_30fps.mp4`;

    const canvas = document.createElement('canvas');

    videoComparison.appendChild(video);
    videoComparison.appendChild(canvas);
    container.appendChild(videoComparison);
  }

  function switchScene(scene) {
    currentScene = scene;
    updateActiveTab('scene-tabs', scene);
    updateActiveTab('method-tabs', state[scene].method);
    updateActiveTab('view-tabs', state[scene].view);
    createVideoComparison();
  }

  function switchMethod(method) {
    state[currentScene].method = method;
    updateActiveTab('method-tabs', method);
    createVideoComparison();
  }

  function switchView(view) {
    state[currentScene].view = view;
    updateActiveTab('view-tabs', view);
    createVideoComparison();
  }

  // Initialize the tabs and content
  createTabs('scene-tabs', scenes, switchScene);
  createTabs('method-tabs', methods, switchMethod);
  createTabs('view-tabs', views, switchView);

  // Set initial active tabs
  updateActiveTab('scene-tabs', currentScene);
  updateActiveTab('method-tabs', state[currentScene].method);
  updateActiveTab('view-tabs', state[currentScene].view);

  // Create initial video comparison
  createVideoComparison();
</script>